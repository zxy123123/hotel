<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/themes/icon.css" />
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/layer/layer.js"></script>
</head>
<body>
    <div>
        <table border="1" cellpadding="1" cellspacing="1" width="100%" align="center">
            <tr>
            <th><button onclick="fun()">批量删除</button></th>
                <th>帖子名</th>
                <th>所属贴吧</th>
                <th>所属分类</th>
                <th>发帖人</th>
                <th width="200px">帖子内容</th>
                <th>浏览量</th>
                <th>评论数</th>
                <th>关注数</th>
                <th>分享数</th>
                <th>操作</th>
            </tr>
<volist name="list" id="vo">
            <tr>
            <td><input type="checkbox" value="{$vo.id}" name="test"></td>
                <td>{$vo.title}</td>
                <td>{$vo.tdn}</td>
                <td>{$vo.tcdn}</td>
                <td>{$vo.nickname}</td>
                <td>{$vo.content}</td>
                <td>{$vo.view_num}</td>
                <td>{$vo.comment_num}</td>
                <td>{$vo.heart_num}</td>
                <td>{$vo.share_num}</td>
                <td><button class="del" bh="{$vo.id}">删除</button></td>
            </tr>
</volist>
        </table>
    </div>

    <script>
    $('.del').click(function(){
        var id = $(this).attr('bh');
        if (confirm('确认删除吗?') == true) 
        {
            $.ajax({
                type:'post',
                url:"{:U('Tieba/opcdel')}",
                dataType:"json",
                data:{'id':id},
                success:function(data){
                    if (data > 0) 
                    {
                        alert('已删除');
                        window.location.reload();
                    }else{
                        alert('删除失败');
                    }
                }
            })
        }
    })

function fun(){
    obj = document.getElementsByName("test");
    check_val = [];
    for(k in obj){
        if(obj[k].checked)
            check_val.push(obj[k].value);
    }
    var arr = check_val;
    $.ajax({
        type:'post',
        url:"{:U('Tieba/alldel')}",
        dataType:"json",
        data:{'id':arr},
        success:function(data){
                    if (data == '1') 
                    {
                        alert('已删除');
                        window.location.reload();
                    }else{
                        alert('删除失败');
                    }
        }
    })
}


    </script>





</body>
</html>